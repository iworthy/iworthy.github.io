(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{434:function(n,a,t){"use strict";t.r(a);var e=t(12),s=Object(e.a)({},(function(){var n=this,a=n._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("p",[n._v("定时备份是一个好习惯，防止服务器意外崩溃而导致文件丢失。LNMP一键包中自带备份脚本，我们可以设置自动或者定时备份到服务器对应目录，也可以备份到远程FTP空间中。由于无法直接备份到腾讯云COS存储，于是采用ftp备份到另一台服务器，由宝塔里的腾讯云COS插件进行二次备份。")]),n._v(" "),a("p",[n._v("##LNMP自带备份脚本配置##\n###1.位置###")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("/root/lnmp1.6/tools/backup.sh\n")])])]),a("p",[n._v("###2.修改配置文件###\n"),a("img",{attrs:{src:"https://alist.worthy.cc/d/local/images/2019/10/07/1570434425.png",alt:"Snipaste_2019-10-07_15-46-53.png"}}),n._v("\n###3.执行备份查看配置是否正确###")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("./backup.sh\n")])])]),a("p",[n._v("执行后本地备份正常，ftp异常。于是开放相应端口，再次测试提示Fatal Error: Certificate Verification: Not Trusted\n原因是证书未被信任，解决办法：编辑/etc/lftp.conf，加入如下内容即可")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("set ssl:verify-certificate no\n")])])]),a("p",[n._v("再次执行后，本地和ftp备份都成功。\n"),a("img",{attrs:{src:"https://alist.worthy.cc/d/local/images/2019/10/07/1570434899.png",alt:"Snipaste_2019-10-07_15-54-26.png"}}),n._v("\n###4.结合crontab设置定时备份###\n####关于crontab####\ncrontab命令常见于Unix和Linux的操作系统之中，用于设置周期性被执行的指令。\n####安装crontab####")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("yum install vixie-cron crontabs\nchkconfig crond on\nservice crond start\n")])])]),a("p",[n._v("####添加定时脚本####")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("crontab -e\n")])])]),a("p",[n._v("####编辑定时脚本，然后添加：####")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("0 3 * * * /root/lnmp1.6/tools/backup.sh\n")])])]),a("p",[n._v("设置每天凌晨3点执行一次,至此自动备份就成功了。只需要在宝塔进行二次备份就可以备份到腾讯云COS。")]),n._v(" "),a("p",[n._v("##Crontab 命令##\n###服务相关命令：###")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("# 安装\nyum -y install vixie-cron crontabs\n#查看状态\nservice crond status\n#启动\nservice crond start\n#关闭\nservice crond stop\n#重启\nservice crond restart\n")])])]),a("p",[n._v("###crontab 命令：###")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("crontab [-u user] file\ncrontab [-u user] [ -e | -l | -r ]\n")])])]),a("p",[n._v("###命令参数：###")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("-u user：用来设定某个用户的crontab服务，例如，“-u ixdba”表示设定ixdba用户的crontab服务，此参数一般有root用户来运行。\n\nfile：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。\n\n-e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。\n\n-l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。\n\n-r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。\n\n-i：在删除用户的crontab文件时给确认提示\n")])])]),a("p",[n._v("###crontab格式：###\n每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("minute   hour   day   month   week   command\n# For details see man 4 crontabs\n# Example of job definition:\n.---------------------------------- minute (0 - 59) 表示分钟\n|  .------------------------------- hour (0 - 23)   表示小时\n|  |  .---------------------------- day of month (1 - 31)   表示日期\n|  |  |  .------------------------- month (1 - 12) OR jan,feb,mar,apr ... 表示月份\n|  |  |  |  .---------------------- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat  表示星期（0 或 7 表示星期天）\n|  |  |  |  |  .------------------- username  以哪个用户来执行 \n|  |  |  |  |  |            .------ command  要执行的命令，可以是系统命令，也可以是自己编写的脚本文件\n|  |  |  |  |  |            |\n*  *  *  *  * user-name  command to be executed\n")])])])])}),[],!1,null,null,null);a.default=s.exports}}]);