(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{479:function(a,s,e){"use strict";e.r(s);var t=e(12),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"使用-acme-sh-自动化ssl证书管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-acme-sh-自动化ssl证书管理"}},[a._v("#")]),a._v(" 使用 acme.sh 自动化SSL证书管理")]),a._v(" "),s("p",[a._v("随着网站安全性的重视，SSL/TLS 证书的应用变得越来越普遍。对于拥有大量子域名的网站来说，为每个子域名单独购买和管理证书可能会变得繁琐和昂贵。幸运的是，泛域名证书的出现解决了这个问题。而通过 acme.sh，您可以轻松实现泛域名证书的自动化申请和管理。本文将向您介绍如何使用 acme.sh 来申请泛域名证书。")]),a._v(" "),s("h2",{attrs:{id:"什么是泛域名证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是泛域名证书"}},[a._v("#")]),a._v(" 什么是泛域名证书？")]),a._v(" "),s("p",[a._v("泛域名证书（Wildcard SSL Certificate）是一种 SSL/TLS 证书，可以用于保护主域名下的所有子域名。与传统的 SSL 证书不同，泛域名证书可以通过一个证书覆盖所有子域名，而无需为每个子域名单独购买和管理证书。这极大地简化了证书管理的工作，并提高了网站的安全性。")]),a._v(" "),s("h2",{attrs:{id:"使用-acme-sh-申请泛域名证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-acme-sh-申请泛域名证书"}},[a._v("#")]),a._v(" 使用 acme.sh 申请泛域名证书")]),a._v(" "),s("p",[a._v("acme.sh 是一个开源的 ACME 协议客户端，可以用于自动化获取和管理 SSL/TLS 证书。它提供了简单的命令行接口，可以轻松实现证书的申请和管理。以下是使用 acme.sh 申请泛域名证书的步骤：")]),a._v(" "),s("h3",{attrs:{id:"步骤一-安装-acme-sh"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤一-安装-acme-sh"}},[a._v("#")]),a._v(" 步骤一：安装 acme.sh")]),a._v(" "),s("p",[a._v("首先，您需要在您的服务器上安装 acme.sh。您可以通过以下命令在 Linux 系统上进行安装：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" https://get.acme.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("email")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("my@example.com\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("把 acme.sh 安装到你的 "),s("strong",[a._v("home")]),a._v(" 目录下:")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("~/.acme.sh/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("并创建 一个 shell 的 alias, 例如 .bashrc，方便你的使用: "),s("code",[a._v("alias acme.sh=~/.acme.sh/acme.sh")])]),a._v(" "),s("h3",{attrs:{id:"步骤二-申请泛域名证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤二-申请泛域名证书"}},[a._v("#")]),a._v(" 步骤二：申请泛域名证书")]),a._v(" "),s("h4",{attrs:{id:"dns-api-模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dns-api-模式"}},[a._v("#")]),a._v(" DNS API 模式")]),a._v(" "),s("p",[a._v("这里以腾讯云为例，登录 "),s("a",{attrs:{href:"https://console.dnspod.cn/",target:"_blank",rel:"noopener noreferrer"}},[a._v("DNSPod 后台"),s("OutboundLink")],1),a._v("：")]),a._v(" "),s("ul",[s("li",[a._v("点击页面右上角头像、点击 "),s("code",[a._v("API 密钥")]),a._v(" 菜单、选择 "),s("code",[a._v("DNSPod Token")])]),a._v(" "),s("li",[a._v("点击 "),s("code",[a._v("创建密钥")]),a._v(" 取一个名称如 "),s("code",[a._v("acme.sh")]),a._v("，就能生成一个随机的 "),s("code",[a._v("ID")]),a._v("、"),s("code",[a._v("Token")]),a._v("。")])]),a._v(" "),s("p",[a._v("执行以下命令申请证书：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Dnspod.cn Domain Api Token")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DP_Id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1234"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DP_Key")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sADDsdasdgdsf"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 申请证书，执行后参数将保存至 ~/.acme.sh/account.conf 在自动续期时使用。")]),a._v("\n$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--issue")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dns")]),a._v(" dns_dp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" example.com "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" *.example.com\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("h3",{attrs:{id:"步骤三-安装证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤三-安装证书"}},[a._v("#")]),a._v(" 步骤三：安装证书")]),a._v(" "),s("p",[a._v("证书申请成功后，您可以使用以下命令将证书安装到您的服务器上：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("acme.sh --install-cert "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'*.example.com'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--key-file /path/to/private/key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--fullchain-file /path/to/fullchain/cert "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--reloadcmd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"service nginx reload"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("在这条命令中，您需要将 "),s("code",[a._v("/path/to/private/key")]),a._v(" 和 "),s("code",[a._v("/path/to/fullchain/cert")]),a._v(" 替换为您希望存储私钥和证书链的文件路径，并根据您使用的服务器软件修改 "),s("code",[a._v("--reloadcmd")]),a._v(" 参数。")]),a._v(" "),s("h3",{attrs:{id:"步骤四-定期更新证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤四-定期更新证书"}},[a._v("#")]),a._v(" 步骤四：定期更新证书")]),a._v(" "),s("p",[a._v("为了保证证书的有效性，建议定期更新证书。您可以使用 acme.sh 提供的自动更新功能，通过添加一个 Cron 任务来定期执行证书更新操作。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("crontab")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输入以下任务")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" * * * "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"~/.acme.sh"')]),a._v("/acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--cron")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--home")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"~/.acme.sh"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h2",{attrs:{id:"通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通知"}},[a._v("#")]),a._v(" 通知")]),a._v(" "),s("p",[a._v("acme.sh 可以在定时任务执行时发送通知。例如在每天晚上的检查任务运行时，您可能会收到基于 notify-level 和 notify-mode 设置的通知。")]),a._v(" "),s("h3",{attrs:{id:"set-notification-for-ios-bark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set-notification-for-ios-bark"}},[a._v("#")]),a._v(" Set notification for iOS Bark")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BARK_API_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://api.day.app/XXXXXXXXXXXXXXXXXXXXXX"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BARK_SOUND")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"newmail"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BARK_GROUP")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ACME\nacme.sh --set-notify --notify-hook bark\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"其他操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他操作"}},[a._v("#")]),a._v(" 其他操作")]),a._v(" "),s("p",[a._v("1、查看已签发证书的域名：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("2、移除不需要再次签发证书的域名：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--remove")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" example.com\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("3、强制刷新证书")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--renew")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" example.com "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--force")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("4、查看已安装证书信息")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--info")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 会输出如下内容：")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOMAIN_CONF")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/root/.acme.sh/example.com/example.com.conf\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Le_Domain")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("example.com\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Le_Alt")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("no\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Le_Webroot")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("dns_ali\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("5、卸载")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--uninstall")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"结语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[a._v("#")]),a._v(" 结语")]),a._v(" "),s("p",[a._v("通过 acme.sh，申请和管理泛域名证书变得轻松愉快。泛域名证书可以为您的主域名下的所有子域名提供安全的 HTTPS 连接，保护用户数据的安全性和隐私性。立即使用 acme.sh，为您的网站加密通信，提升安全性！")])])}),[],!1,null,null,null);s.default=r.exports}}]);